<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üîã Solar Output Predictor</title>

  <!--Embedded CSS-->
  <style>
    /* === Global Reset and Layout === */
    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #e1f5fe, #e8f5e9); /* Soft blue to green gradient */
      color: #2c3e50; /* Dark slate blue text */
    }

    /* === Page Container === */
    .container {
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    /* === Top Section: Input Form Area === */
    .top-section {
      flex: 7;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: start;
      padding-top: 40px;
    }

    /* === Bottom Section: Prediction Output Display === */
    .bottom-section {
      flex: 3;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5em;
      font-weight: bold;
      color: #1b5e20; /* Dark green text */
      text-align: center;
      background: #e9fbe9; /* Pale green background */
    }

    /* === Header Styling === */
    h1 {
      color: #2e7d32; /* Forest green */
      font-size: 2rem;
      margin-bottom: 20px;
    }

    /* === Form Styling === */
    form {
      background: #ffffff;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1); /* Subtle shadow */
      width: 90%;
      max-width: 850px;
    }

    /* === Form Grid Layout === */
    .form-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
    }

    /* === Individual Form Group (Label + Input) === */
    .form-group {
      display: flex;
      flex-direction: column;
    }

    /* === Label Styling === */
    label {
      font-weight: 600;
      margin-bottom: 5px;
      color: #2e7d32; /* Forest green */
    }

    /* === Input and Select Field Styling === */
    input, select {
      padding: 10px;
      border: 1px solid #c8e6c9; /* Light green border */
      border-radius: 6px;
      background-color: #f4fff4; /* Very pale green background */
    }

    /* === Full-Width Element (Submit Button) === */
    .full-width {
      grid-column: span 3;
    }

    /* === Button Styling === */
    button {
      background: #43a047; /* Medium green */
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      font-size: 1rem;
      margin-top: 20px;
      width: 100%;
    }

    /* === Button Hover Effect === */
    button:hover {
      background: #2e7d32; /* Darker green */
    }

    /* === Responsive Design for Small Screens === */
    @media (max-width: 768px) {
      .form-grid {
        grid-template-columns: 1fr; /* Stack inputs vertically */
      }
      .full-width {
        grid-column: span 1;
      }
    }
  </style>
</head>


<body>
  <div class="container">
    <div class="top-section">
      <h1>üîã Solar Output Predictor</h1>
      
      <!--HTML Form Structure-->
      <form id="solar-form">
        <div class="form-grid">
          <div class="form-group">
            <label for="location_type">Location Type</label>
            <select id="location_type" required>
              <option value="" disabled selected hidden>Select</option>
              <option value="rural">Rural</option>
              <option value="urban">Urban</option>
              <option value="industrial">Industrial</option>
            </select>
          </div>

          <div class="form-group">
            <label for="avg_temperature_C">Avg. Temp (¬∞C)</label>
            <input type="number" id="avg_temperature_C" step="0.1" min="-5" max="35" required>
          </div>

          <div class="form-group">
            <label for="cloud_coverage_percent">Cloud Coverage (%)</label>
            <input type="number" id="cloud_coverage_percent" step="0.1" min="0" max="100" required>
          </div>

          <div class="form-group">
            <label for="wind_speed_kmph">Wind Speed (kmph)</label>
            <input type="number" id="wind_speed_kmph" step="0.1" min="0" max="30" required>
          </div>

          <div class="form-group">
            <label for="humidity_percent">Humidity (%)</label>
            <input type="number" id="humidity_percent" step="0.1" min="5" max="100" required>
          </div>

          <div class="form-group">
            <label for="panel_age_years">Panel Age (Years)</label>
            <input type="number" id="panel_age_years" step="1" min="0" max="30" required>
          </div>

          <div class="form-group">
            <label for="panel_efficiency_percent">Panel Efficiency (%)</label>
            <input type="number" id="panel_efficiency_percent" step="0.1" min="10" max="23" required>
          </div>

          <div class="form-group">
            <label for="solar_radiation_kWh_m2">Solar Radiation (kWh/m¬≤)</label>
            <input type="number" id="solar_radiation_kWh_m2" step="0.1" min="0" max="250" required>
          </div>

          <div class="form-group">
            <label for="installed_capacity_kw">Installed Capacity (kW)</label>
            <input type="number" id="installed_capacity_kw" step="0.5" min="1" required>
          </div>
        </div>

        <div class="form-group full-width">
          <button type="submit">Predict Output</button>
        </div>
      </form>
    </div>

    <!--Output Div-->
    <div class="bottom-section" id="output">
      Enter values and click Predict to see results here.
    </div>
  </div>

  <!--JavaScript Logic-->
  <script>

    // Mapping location types to numerical values used in the model
    const locationMap = {
      rural: 1.2,
      urban: 1.0,
      industrial: 0.9
    };

    // Add event listener for form submission
    document.getElementById("solar-form").onsubmit = async function (e) {
      e.preventDefault();
      
      // Get selected location and convert to numeric encoding
      const selectedLocation = document.getElementById("location_type").value;
      if (!locationMap[selectedLocation]) {
        alert("Please select a valid location.");
        return;
      }
      const locationEncoded = locationMap[selectedLocation];
      
      // Get installed capacity separately for final output calculation
      const installedCapacity = parseFloat(document.getElementById("installed_capacity_kw").value);

      // Collect all input values from the form
      const inputData = {
        location_type: locationEncoded,
        avg_temperature_C: parseFloat(document.getElementById("avg_temperature_C").value),
        cloud_coverage_percent: parseFloat(document.getElementById("cloud_coverage_percent").value),
        wind_speed_kmph: parseFloat(document.getElementById("wind_speed_kmph").value),
        humidity_percent: parseFloat(document.getElementById("humidity_percent").value),
        panel_age_years: parseInt(document.getElementById("panel_age_years").value),
        panel_efficiency_percent: parseFloat(document.getElementById("panel_efficiency_percent").value),
        solar_radiation_kWh_m2: parseFloat(document.getElementById("solar_radiation_kWh_m2").value)
      };


      try {
        // Send input data to the backend Flask API using fetch()
        const response = await fetch("https://solar-output-predictor-rpmh.onrender.com/predict", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(inputData)
        });

        // Parse API response as JSON
        const result = await response.json();

        //Checking API response before multiplying it with installedCapacity
        if (result.error) {
          document.getElementById("output").innerText = "Error: " + result.error;
        } else {
          //Ensuring totalOutput is non-negative
          const totalOutput = Math.max(0, result.normalized_output_kWh * installedCapacity);

          //Displaying totalOutput in Output div dynamically
          document.getElementById("output").innerHTML =
            `üîã Estimated Monthly Output: ${totalOutput.toFixed(2)} kWh`;
        }
      } catch (err) {
        // Catch network or unexpected errors
        document.getElementById("output").innerText = "‚ùå API Error: " + err.message;
      }
    };
  </script>

</body>
</html>

